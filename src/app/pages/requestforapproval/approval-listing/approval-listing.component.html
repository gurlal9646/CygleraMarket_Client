<div class="card">
    <div class="card-header border-0 pt-6">
      <!--begin::Card title-->
      <div class="card-title">
        <!--begin::Search-->
        <div class="d-flex align-items-center position-relative my-1">
          <input
            type="text"
            data-action="filter"
            class="form-control form-control-solid w-250px ps-12"
            placeholder="Search Requests"
            (keyup)="quicksearch()"
            [(ngModel)]="searchvalue"
          />
        </div>
        <!--end::Search-->
      </div>
      <!--begin::Card title-->
  
      <!--begin::Card toolbar-->
      <div class="card-toolbar">
        <!--begin::Toolbar-->
        <div class="d-flex justify-content-end">
        </div>
        <!--end::Toolbar-->
      </div>
      <!--end::Card toolbar-->
    </div>
  
    <div class="card-body pt-0">
      <!--Grid code-->
      <ag-grid-angular
        id="requestList"
        style="width: 100%; height: calc(100vh - 350px)"
        [columnDefs]="columnDefsUsers"
        [defaultColDef]="defaultColDef"
        [enableRangeSelection]="true"
        [paginationPageSize]="paginationPageSize"
        [pagination]="true"
        [gridOptions]="gridOptions"
        [suppressRowClickSelection]="true"
        [rowSelection]="rowSelection"
        (selectionChanged)="onSelectionChanged($event)"
        [overlayLoadingTemplate]="overlayLoadingTemplate"
        (gridReady)="onGridReadyMember($event)"
        aria-hidden="true"
      ></ag-grid-angular>
    </div>
  </div>

  <ng-template #approveModal let-modal>
    <form #myForm="ngForm" (ngSubmit)="onSubmit($event, myForm)">
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Review Price</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div class="modal-body">
        <div class="d-flex flex-column scroll-y me-n7 pe-7 mw-650px" id="kt_modal_update_customer_scroll" data-kt-scroll="true" data-kt-scroll-activate="{default: false, lg: true}" data-kt-scroll-max-height="auto" data-kt-scroll-dependencies="#kt_modal_update_customer_header" data-kt-scroll-wrappers="#kt_modal_update_customer_scroll"
          data-kt-scroll-offset="300px">
          <!--begin::User toggle-->
          <div class="fw-bold fs-3 rotate collapsible mb-7" data-bs-toggle="collapse" role="button" (click)="collapse1.toggle()" [attr.aria-expanded]="!isCollapsed1" aria-controls="kt_modal_update_customer_user_info">Review Price
            <span class="ms-2 rotate-180">
              <i class="ki-duotone ki-down fs-3" [ngClass]="{ 'ki-up': !isCollapsed1 }"></i>
            </span>
          </div>
          <!--end::User toggle-->
          <!--begin::User form-->
          <div class="collapse show" #collapse1="ngbCollapse" [(ngbCollapse)]="isCollapsed1">
            <!--begin::Input group-->
            <div class="fv-row mb-7">
              <!--begin::Label-->
              <label class="required fw-semibold fs-6 mb-2" for="price">Price</label>
              <!--end::Label-->
              <!--begin::Input-->
              <input type="number" class="form-control form-control-solid" name="price" [(ngModel)]="price" #name="ngModel" required />
              <!--end::Input-->
            </div>
            <!--end::Input group-->
          </div>
          <!--end::User form-->
        </div>
      </div>
      <div class="modal-footer flex-center">
        <!--begin::Button-->
        <button type="reset" id="kt_modal_update_customer_cancel" class="btn btn-light me-3" (click)="modal.dismiss('cancel')">
          Discard
        </button>
        <!--end::Button-->
    
        <!--begin::Button-->
        <button type="submit" id="kt_modal_update_customer_submit" class="btn btn-primary" [attr.data-kt-indicator]="isLoading ? 'on' : 'off'">
          <span class="indicator-label">
            Submit
          </span>
          <span class="indicator-progress">
            Please wait... <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
          </span>
        </button>
        <!--end::Button-->
      </div>
    </form>
    </ng-template>
  

    <ng-template #negotiationModal let-modal>
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Negotiation Conversation</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div
      class="scroll-y me-n5 pe-5"
      [ngClass]="!isDrawer ? 'h-300px h-lg-auto' : ''"
      data-kt-element="messages"
      data-kt-scroll="true"
      data-kt-scroll-activate="{default: false, lg: true}"
      data-kt-scroll-max-height="auto"
      [attr.data-kt-scroll-dependencies]="
        isDrawer
          ? '#kt_drawer_chat_messenger_header, #kt_drawer_chat_messenger_footer'
          : '#kt_header, #kt_toolbar, #kt_footer, #kt_chat_messenger_header, #kt_chat_messenger_footer'
      "
      [attr.data-kt-scroll-wrappers]="
        isDrawer
          ? '#kt_drawer_chat_messenger_body'
          : '#kt_content, #kt_chat_messenger_body'
      "
      [attr.data-kt-scroll-offset]="isDrawer ? '0px' : '-2px'"
    >
      <ng-container *ngFor="let message of conversationList">
        <div
          [ngClass]="{
            'd-flex': !isDrawer,
            'justify-content-start': message.sellerId === '',
            'justify-content-end': message.sellerId !== ''
          }"
          [attr.data-kt-element]="'template-' + message.sellerId"
          class="mb-10"
        >
          <div
            class="d-flex flex-column align-items"
            [ngClass]="'align-items-' + (message.sellerId !== '' ? 'start' : 'end')"
          >
            <div class="d-flex align-items-center mb-2">
              <ng-container *ngIf="message.sellerId === ''">
                <div div class="symbol symbol-35px symbol-circle">
                  <img
                    alt="Pic"
                  />
                </div>
                <div class="ms-3">
                  <a
                    href="#"
                    class="fs-5 fw-bolder text-gray-900 text-hover-primary me-1"
                  >
                      Buyer                  </a>
                  <span class="text-muted fs-7 mb-1">{{ message.time }}</span>
                </div>
              </ng-container>
              <ng-container *ngIf="message.sellerId !== ''">
                <div class="me-3">
                  <span class="text-muted fs-7 mb-1">{{ message.time }}</span>
                  <a
                    href="#"
                    class="fs-5 fw-bolder text-gray-900 text-hover-primary ms-1"
                  >
                    Seller
                  </a>
                </div>
                <div class="symbol symbol-35px symbol-circle">
                
                </div>
              </ng-container>
            </div>
    
            <div
              [ngClass]="getMessageCssClass(message)"
              data-kt-element="message-text"
              [innerHTML]="message.message"
            ></div>
          </div>
        </div>
      </ng-container>
    </div>
    
    <div
      class="card-footer pt-4" 
      style="margin: 5px;"
      [id]="
        isDrawer ? 'kt_drawer_chat_messenger_footer' : 'kt_chat_messenger_footer'
      "
    >
      <textarea
        #messageInput
        class="form-control form-control-flush mb-3"
        rows="1"
        data-kt-element="input"
        placeholder="Type a message"
      ></textarea>
    
      <div class="d-flex flex-stack">
        <div class="d-flex align-items-center me-2">
        </div>
        <button
          class="btn btn-primary"
          type="button"
          data-kt-element="send"
          (click)="sendMessage()"
        >
          Send
        </button>
      </div>
    </div>
    
    </ng-template>
    
    